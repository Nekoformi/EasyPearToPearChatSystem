#!/bin/bash

isDebugMode=0

displayWidth=1920
displayHeight=1080
timeout=120000 # 2 min
beacon=3840000 # 15 ~ 60 sec / 128 nodes

clusterNumber=0

echo "Enter the cluster number for this computer:"
read -p "" clusterNumber

address=$(hostname -I)
number=`printf "%04d" "$((clusterNumber))"`

echo "/// Information:"
echo "=SoT============================================================================"
echo "Cluster address: ${address}"
echo "Cluster number: ${number}"
echo "============================================================================EoT="

clusterAddress_0001="0.0.0.0"
clusterAddress_0002="0.0.0.0"
clusterAddress_0003="0.0.0.0"
clusterAddress_0004="0.0.0.0"
clusterAddress_0005="0.0.0.0"
clusterAddress_0006="0.0.0.0"
clusterAddress_0007="0.0.0.0"
clusterAddress_0008="0.0.0.0"

case "$number" in
    "0001" )
        if [[ $isDebugMode -eq 0 ]]; then
            bash ./"TestC.sh" 1 4 4 "$displayWidth" "$displayHeight" "$timeout" "$beacon"
        fi

        echo "/// Next task:"
        echo "=SoT============================================================================"
        echo "Set up cluster 0002."
        echo "============================================================================EoT="
        echo "/// Run the following command on each client:"
        echo "=SoT============================================================================"
        echo "Task 0013:"
        echo "    C0001_U0013:"
        echo "        /delay @00010000000000000000000000000000 67" # C0002_U0001
        echo "    C0001_U0014:"
        echo "        /delay @00010001000000000000000000000000 67" # C0002_U0002
        echo "    C0001_U0015:"
        echo "        /delay @00010002000000000000000000000000 67" # C0002_U0003
        echo "    C0001_U0016:"
        echo "        /delay @00010003000000000000000000000000 67" # C0002_U0004
        echo "--------------------------------------------------------------------------------"
        echo "Task 0014:"
        echo "    C0001_U0001:"
        echo "        /delay @00030003000000000000000000000000 222" # C0004_U0004
        echo "    C0001_U0005:"
        echo "        /delay @00030007000000000000000000000000 222" # C0004_U0008
        echo "    C0001_U0009:"
        echo "        /delay @0003000b000000000000000000000000 222" # C0004_U0012
        echo "    C0001_U0013:"
        echo "        /delay @0003000f000000000000000000000000 222" # C0004_U0016
        echo "--------------------------------------------------------------------------------"
        echo "Task 0015:"
        echo "    C0001_U0004:"
        echo "        /delay @00050000000000000000000000000000 148" # C0006_U0001
        echo "    C0001_U0008:"
        echo "        /delay @00050004000000000000000000000000 148" # C0006_U0005
        echo "--------------------------------------------------------------------------------"
        echo "Task 0016:"
        echo "    C0001_U0012:"
        echo "        /delay @00060000000000000000000000000000 98" # C0007_U0001
        echo "    C0001_U0016:"
        echo "        /delay @00060004000000000000000000000000 98" # C0007_U0005
        echo "============================================================================EoT=";;
    "0002" )
        if [[ $isDebugMode -eq 0 ]]; then
            echo "Enter the IP address of cluster 0001:"
            read -p "" clusterAddress_0001

            bash ./"TestC.sh" 2 4 4 "$displayWidth" "$displayHeight" "$timeout" "$beacon" "${clusterAddress_0001}:20013"
        fi

        echo "/// Next task:"
        echo "=SoT============================================================================"
        echo "Set up cluster 0003."
        echo "============================================================================EoT="
        echo "/// Run the following command on each client:"
        echo "=SoT============================================================================"
        echo "Task 0001:"
        echo "    C0002_U0001:"
        echo "        /connect @0000000c000000000000000000000000" # C0001_U0013
        echo "        /delay @0000000c000000000000000000000000 67" # C0001_U0013
        echo "    C0002_U0002:"
        echo "        /connect @0000000d000000000000000000000000" # C0001_U0014
        echo "        /delay @0000000d000000000000000000000000 67" # C0001_U0014
        echo "    C0002_U0003:"
        echo "        /connect @0000000e000000000000000000000000" # C0001_U0015
        echo "        /delay @0000000e000000000000000000000000 67" # C0001_U0015
        echo "    C0002_U0004:"
        echo "        /connect @0000000f000000000000000000000000" # C0001_U0016
        echo "        /delay @0000000f000000000000000000000000 67" # C0001_U0016
        echo "--------------------------------------------------------------------------------"
        echo "Task 0017:"
        echo "    C0002_U0013:"
        echo "        /delay @00020000000000000000000000000000 92" # C0003_U0001
        echo "    C0002_U0014:"
        echo "        /delay @00020001000000000000000000000000 92" # C0003_U0002
        echo "    C0002_U0015:"
        echo "        /delay @00020002000000000000000000000000 92" # C0003_U0003
        echo "    C0002_U0016:"
        echo "        /delay @00020003000000000000000000000000 92" # C0003_U0004
        echo "--------------------------------------------------------------------------------"
        echo "Task 0018:"
        echo "    C0002_U0001:"
        echo "        /delay @00040003000000000000000000000000 292" # C0005_U0004
        echo "    C0002_U0005:"
        echo "        /delay @00040007000000000000000000000000 292" # C0005_U0008
        echo "    C0002_U0009:"
        echo "        /delay @0004000b000000000000000000000000 292" # C0005_U0012
        echo "    C0002_U0013:"
        echo "        /delay @0004000f000000000000000000000000 292" # C0005_U0016
        echo "============================================================================EoT=";;
    "0003" )
        if [[ $isDebugMode -eq 0 ]]; then
            echo "Enter the IP address of cluster 0002:"
            read -p "" clusterAddress_0002

            bash ./"TestC.sh" 3 4 4 "$displayWidth" "$displayHeight" "$timeout" "$beacon" "${clusterAddress_0002}:20013"
        fi

        echo "/// Next task:"
        echo "=SoT============================================================================"
        echo "Set up cluster 0006."
        echo "============================================================================EoT="
        echo "/// Run the following command on each client:"
        echo "=SoT============================================================================"
        echo "Task 0002:"
        echo "    C0003_U0001:"
        echo "        /connect @0001000c000000000000000000000000" # C0002_U0013
        echo "        /delay @0001000c000000000000000000000000 92" # C0002_U0013
        echo "    C0003_U0002:"
        echo "        /connect @0001000d000000000000000000000000" # C0002_U0014
        echo "        /delay @0001000d000000000000000000000000 92" # C0002_U0014
        echo "    C0003_U0003:"
        echo "        /connect @0001000e000000000000000000000000" # C0002_U0015
        echo "        /delay @0001000e000000000000000000000000 92" # C0002_U0015
        echo "    C0003_U0004:"
        echo "        /connect @0001000f000000000000000000000000" # C0002_U0016
        echo "        /delay @0001000f000000000000000000000000 92" # C0002_U0016
        echo "--------------------------------------------------------------------------------"
        echo "Task 0019:"
        echo "    C0003_U0008:"
        echo "        /delay @00060008000000000000000000000000 137" # C0007_U0009
        echo "    C0003_U0012:"
        echo "        /delay @0006000c000000000000000000000000 137" # C0007_U0013
        echo "============================================================================EoT=";;
    "0004" )
        if [[ $isDebugMode -eq 0 ]]; then
            echo "Enter the IP address of cluster 0006:"
            read -p "" clusterAddress_0006

            bash ./"TestC.sh" 4 4 4 "$displayWidth" "$displayHeight" "$timeout" "$beacon" "${clusterAddress_0006}:20008"
        fi

        echo "/// Next task:"
        echo "=SoT============================================================================"
        echo "Set up cluster 0005."
        echo "============================================================================EoT="
        echo "/// Run the following command on each client:"
        echo "=SoT============================================================================"
        echo "Task 0003:"
        echo "    C0004_U0004:"
        echo "        /connect @00000000000000000000000000000000" # C0001_U0001
        echo "        /delay @00000000000000000000000000000000 222" # C0001_U0001
        echo "    C0004_U0008:"
        echo "        /connect @00000004000000000000000000000000" # C0001_U0005
        echo "        /delay @00000004000000000000000000000000 222" # C0001_U0005
        echo "    C0004_U0012:"
        echo "        /connect @00000008000000000000000000000000" # C0001_U0009
        echo "        /delay @00000008000000000000000000000000 222" # C0001_U0009
        echo "    C0004_U0016:"
        echo "        /connect @0000000c000000000000000000000000" # C0001_U0013
        echo "        /delay @0000000c000000000000000000000000 222" # C0001_U0013
        echo "--------------------------------------------------------------------------------"
        echo "Task 0004:"
        echo "    C0004_U0001:"
        echo "        /connect @00050007000000000000000000000000" # C0006_U0008
        echo "        /delay @00050007000000000000000000000000 77" # C0006_U0008
        echo "    C0004_U0005:"
        echo "        /connect @0005000b000000000000000000000000" # C0006_U0012
        echo "        /delay @0005000b000000000000000000000000 77" # C0006_U0012
        echo "--------------------------------------------------------------------------------"
        echo "Task 0005:"
        echo "    C0004_U0009:"
        echo "        /connect @00070007000000000000000000000000" # C0008_U0008
        echo "        /delay @00070007000000000000000000000000 87" # C0008_U0008
        echo "    C0004_U0013:"
        echo "        /connect @0007000b000000000000000000000000" # C0008_U0012
        echo "        /delay @0007000b000000000000000000000000 87" # C0008_U0012
        echo "--------------------------------------------------------------------------------"
        echo "Task 0020:"
        echo "    C0004_U0013:"
        echo "        /delay @00040000000000000000000000000000 9" # C0005_U0001
        echo "    C0004_U0014:"
        echo "        /delay @00040001000000000000000000000000 9" # C0005_U0002
        echo "    C0004_U0015:"
        echo "        /delay @00040002000000000000000000000000 9" # C0005_U0003
        echo "    C0004_U0016:"
        echo "        /delay @00040003000000000000000000000000 9" # C0005_U0004
        echo "============================================================================EoT=";;
    "0005" )
        if [[ $isDebugMode -eq 0 ]]; then
            echo "Enter the IP address of cluster 0004:"
            read -p "" clusterAddress_0004

            bash ./"TestC.sh" 5 4 4 "$displayWidth" "$displayHeight" "$timeout" "$beacon" "${clusterAddress_0004}:20013"
        fi

        echo "/// Next task:"
        echo "=SoT============================================================================"
        echo "Set up each client."
        echo "============================================================================EoT="
        echo "/// Run the following command on each client:"
        echo "=SoT============================================================================"
        echo "Task 0006:"
        echo "    C0005_U0004:"
        echo "        /connect @00010000000000000000000000000000" # C0002_U0001
        echo "        /delay @00010000000000000000000000000000 292" # C0002_U0001
        echo "    C0005_U0008:"
        echo "        /connect @00010004000000000000000000000000" # C0002_U0005
        echo "        /delay @00010004000000000000000000000000 292" # C0002_U0005
        echo "    C0005_U0012:"
        echo "        /connect @00010008000000000000000000000000" # C0002_U0009
        echo "        /delay @00010008000000000000000000000000 292" # C0002_U0009
        echo "    C0005_U0016:"
        echo "        /connect @0001000c000000000000000000000000" # C0002_U0013
        echo "        /delay @0001000c000000000000000000000000 292" # C0002_U0013
        echo "--------------------------------------------------------------------------------"
        echo "Task 0007:"
        echo "    C0005_U0001:"
        echo "        /connect @0003000c000000000000000000000000" # C0004_U0013
        echo "        /delay @0003000c000000000000000000000000 9" # C0004_U0013
        echo "    C0005_U0002:"
        echo "        /connect @0003000d000000000000000000000000" # C0004_U0014
        echo "        /delay @0003000d000000000000000000000000 9" # C0004_U0014
        echo "    C0005_U0003:"
        echo "        /connect @0003000e000000000000000000000000" # C0004_U0015
        echo "        /delay @0003000e000000000000000000000000 9" # C0004_U0015
        echo "    C0005_U0004:"
        echo "        /connect @0003000f000000000000000000000000" # C0004_U0016
        echo "        /delay @0003000f000000000000000000000000 9" # C0004_U0016
        echo "============================================================================EoT=";;
    "0006" )
        if [[ $isDebugMode -eq 0 ]]; then
            echo "Enter the IP address of cluster 0001:"
            read -p "" clusterAddress_0001

            bash ./"TestC.sh" 6 4 4 "$displayWidth" "$displayHeight" "$timeout" "$beacon" "${clusterAddress_0001}:20004"
        fi

        echo "/// Next task:"
        echo "=SoT============================================================================"
        echo "Set up cluster 0007."
        echo "============================================================================EoT="
        echo "/// Run the following command on each client:"
        echo "=SoT============================================================================"
        echo "Task 0008:"
        echo "    C0006_U0001:"
        echo "        /connect @00000003000000000000000000000000" # C0001_U0004
        echo "        /delay @00000003000000000000000000000000 148" # C0001_U0004
        echo "    C0006_U0005:"
        echo "        /connect @00000007000000000000000000000000" # C0001_U0008
        echo "        /delay @00000007000000000000000000000000 148" # C0001_U0008
        echo "--------------------------------------------------------------------------------"
        echo "Task 0021:"
        echo "    C0006_U0008:"
        echo "        /delay @00030000000000000000000000000000 77" # C0004_U0001
        echo "    C0006_U0012:"
        echo "        /delay @00030004000000000000000000000000 77" # C0004_U0005
        echo "--------------------------------------------------------------------------------"
        echo "Task 0022:"
        echo "    C0006_U0013:"
        echo "        /delay @00060000000000000000000000000000 61" # C0007_U0001
        echo "    C0006_U0014:"
        echo "        /delay @00060001000000000000000000000000 61" # C0007_U0002
        echo "    C0006_U0015:"
        echo "        /delay @00060002000000000000000000000000 61" # C0007_U0003
        echo "    C0006_U0016:"
        echo "        /delay @00060003000000000000000000000000 61" # C0007_U0004
        echo "============================================================================EoT=";;
    "0007" )
        if [[ $isDebugMode -eq 0 ]]; then
            echo "Enter the IP address of cluster 0001:"
            read -p "" clusterAddress_0001

            bash ./"TestC.sh" 7 4 4 "$displayWidth" "$displayHeight" "$timeout" "$beacon" "${clusterAddress_0001}:20012"
        fi

        echo "/// Next task:"
        echo "=SoT============================================================================"
        echo "Set up cluster 0008."
        echo "============================================================================EoT="
        echo "/// Run the following command on each client:"
        echo "=SoT============================================================================"
        echo "Task 0009:"
        echo "    C0007_U0001:"
        echo "        /connect @0000000b000000000000000000000000" # C0001_U0012
        echo "        /delay @0000000b000000000000000000000000 98" # C0001_U0012
        echo "    C0007_U0005:"
        echo "        /connect @0000000f000000000000000000000000" # C0001_U0016
        echo "        /delay @0000000f000000000000000000000000 98" # C0001_U0016
        echo "--------------------------------------------------------------------------------"
        echo "Task 0010:"
        echo "    C0007_U0009:"
        echo "        /connect @00020007000000000000000000000000" # C0003_U0008
        echo "        /delay @00020007000000000000000000000000 137" # C0003_U0008
        echo "    C0007_U0013:"
        echo "        /connect @0002000b000000000000000000000000" # C0003_U0012
        echo "        /delay @0002000b000000000000000000000000 137" # C0003_U0012
        echo "--------------------------------------------------------------------------------"
        echo "Task 0011:"
        echo "    C0007_U0001:"
        echo "        /connect @0005000c000000000000000000000000" # C0006_U0013
        echo "        /delay @0005000c000000000000000000000000 61" # C0006_U0013
        echo "    C0007_U0002:"
        echo "        /connect @0005000d000000000000000000000000" # C0006_U0014
        echo "        /delay @0005000d000000000000000000000000 61" # C0006_U0014
        echo "    C0007_U0003:"
        echo "        /connect @0005000e000000000000000000000000" # C0006_U0015
        echo "        /delay @0005000e000000000000000000000000 61" # C0006_U0015
        echo "    C0007_U0004:"
        echo "        /connect @0005000f000000000000000000000000" # C0006_U0016
        echo "        /delay @0005000f000000000000000000000000 61" # C0006_U0016
        echo "--------------------------------------------------------------------------------"
        echo "Task 0023:"
        echo "    C0007_U0013:"
        echo "        /delay @00070000000000000000000000000000 63" # C0008_U0001
        echo "    C0007_U0014:"
        echo "        /delay @00070001000000000000000000000000 63" # C0008_U0002
        echo "    C0007_U0015:"
        echo "        /delay @00070002000000000000000000000000 63" # C0008_U0003
        echo "    C0007_U0016:"
        echo "        /delay @00070003000000000000000000000000 63" # C0008_U0004
        echo "============================================================================EoT=";;
    "0008" )
        if [[ $isDebugMode -eq 0 ]]; then
            echo "Enter the IP address of cluster 0007:"
            read -p "" clusterAddress_0007

            bash ./"TestC.sh" 8 4 4 "$displayWidth" "$displayHeight" "$timeout" "$beacon" "${clusterAddress_0007}:20013"
        fi

        echo "/// Next task:"
        echo "=SoT============================================================================"
        echo "Set up cluster 0004."
        echo "============================================================================EoT="
        echo "/// Run the following command on each client:"
        echo "=SoT============================================================================"
        echo "Task 0012:"
        echo "    C0008_U0001:"
        echo "        /connect @0006000c000000000000000000000000" # C0007_U0013
        echo "        /delay @0006000c000000000000000000000000 63" # C0007_U0013
        echo "    C0008_U0002:"
        echo "        /connect @0006000d000000000000000000000000" # C0007_U0014
        echo "        /delay @0006000d000000000000000000000000 63" # C0007_U0014
        echo "    C0008_U0003:"
        echo "        /connect @0006000e000000000000000000000000" # C0007_U0015
        echo "        /delay @0006000e000000000000000000000000 63" # C0007_U0015
        echo "    C0008_U0004:"
        echo "        /connect @0006000f000000000000000000000000" # C0007_U0016
        echo "        /delay @0006000f000000000000000000000000 63" # C0007_U0016
        echo "--------------------------------------------------------------------------------"
        echo "Task 0024:"
        echo "    C0008_U0008:"
        echo "        /delay @00030008000000000000000000000000 87" # C0004_U0009
        echo "    C0008_U0012:"
        echo "        /delay @0003000c000000000000000000000000 87" # C0004_U0013
        echo "============================================================================EoT=";;
    * )
        echo "Please enter a cluster number between 1 and 8.";;
esac
